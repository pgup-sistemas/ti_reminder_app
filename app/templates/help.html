{% extends "base.html" %}

{% block title %}Ajuda - TI OSN System{% endblock %}

{% block styles %}
<style>
    .help-section {
        margin-bottom: 2rem;
        padding: 1.5rem;
        border: 1px solid #e9ecef;
        border-radius: 0.5rem;
        background-color: #f8f9fa;
    }
    
    .help-section h3 {
        color: #495057;
        border-bottom: 2px solid #007bff;
        padding-bottom: 0.5rem;
        margin-bottom: 1rem;
    }
    
    .notification-rule {
        background-color: #fff;
        border-left: 4px solid #007bff;
        padding: 1rem;
        margin: 1rem 0;
        border-radius: 0 0.25rem 0.25rem 0;
    }
    
    .notification-rule.reminder {
        border-left-color: #28a745;
    }
    
    .notification-rule.chamado {
        border-left-color: #ffc107;
    }
    
    .notification-rule.task {
        border-left-color: #dc3545;
    }
    
    .status-badge {
        display: inline-block;
        padding: 0.25rem 0.5rem;
        font-size: 0.75rem;
        font-weight: 600;
        border-radius: 0.25rem;
        margin: 0.125rem;
    }
    
    .status-badge.active { background-color: #d4edda; color: #155724; }
    .status-badge.paused { background-color: #fff3cd; color: #856404; }
    .status-badge.completed { background-color: #d1ecf1; color: #0c5460; }
    .status-badge.cancelled { background-color: #f8d7da; color: #721c24; }
    
    .quick-access {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1rem;
        margin-top: 2rem;
    }
    
    .quick-access-card {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 1.5rem;
        border-radius: 0.5rem;
        text-decoration: none;
        transition: transform 0.2s;
    }
    
    .quick-access-card:hover {
        transform: translateY(-2px);
        color: white;
        text-decoration: none;
    }
    
    .toc {
        background-color: #e9ecef;
        padding: 1rem;
        border-radius: 0.5rem;
        margin-bottom: 2rem;
    }
    
    .toc ul {
        margin-bottom: 0;
        padding-left: 1.5rem;
    }
    
    .toc a {
        color: #495057;
        text-decoration: none;
    }
    
    .toc a:hover {
        color: #007bff;
        text-decoration: underline;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="d-flex justify-content-between align-items-center mb-4">
                <h1><i class="fas fa-question-circle text-primary"></i> Central de Ajuda</h1>
                <div>
                    <a href="{{ url_for('main.index') }}" class="btn btn-outline-primary">
                        <i class="fas fa-home"></i> Voltar ao Dashboard
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- √çndice -->
    <div class="row">
        <div class="col-12">
            <div class="toc">
                <h5><i class="fas fa-list"></i> √çndice</h5>
                <ul>
                    <li><a href="#notifications">Sistema de Notifica√ß√µes</a></li>
                    <li><a href="#reminders">Lembretes</a></li>
                    <li><a href="#chamados">Chamados</a></li>
                    <li><a href="#tasks">Tarefas</a></li>
                    <li><a href="#tutorials">Tutoriais</a></li>
                    <li><a href="#equipment">Equipamentos</a></li>
                    <li><a href="#troubleshooting">Solu√ß√£o de Problemas</a></li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Sistema de Notifica√ß√µes -->
    <div class="row">
        <div class="col-12">
            <div class="help-section" id="notifications">
                <h3><i class="fas fa-bell"></i> Sistema de Notifica√ß√µes Inteligente</h3>
                
                <div class="alert alert-info">
                    <strong><i class="fas fa-info-circle"></i> Importante:</strong> 
                    O sistema possui regras inteligentes para evitar spam de notifica√ß√µes. Cada tipo tem sua pr√≥pria frequ√™ncia controlada.
                </div>

                <h5>Estados das Notifica√ß√µes</h5>
                <ul>
                    <li><strong>Primeira visita:</strong> Mensagem azul convidativa para ativar</li>
                    <li><strong>Permiss√£o concedida:</strong> Inicia automaticamente, sem mensagens</li>
                    <li><strong>Permiss√£o negada:</strong> Orienta√ß√µes para habilitar manualmente</li>
                    <li><strong>Dispensado:</strong> N√£o mostra novamente por 24 horas</li>
                </ul>

                <h5>Como Ativar Notifica√ß√µes</h5>
                <ol>
                    <li><strong>Autom√°tico:</strong> Clique em "Ativar Agora" na mensagem que aparece</li>
                    <li><strong>Manual:</strong> Clique no √≠cone de cadeado na barra de endere√ßos do navegador</li>
                    <li><strong>Configura√ß√µes:</strong> Acesse configura√ß√µes do navegador > Notifica√ß√µes</li>
                </ol>

                <h5>Regras por Tipo de Notifica√ß√£o</h5>
                
                <div class="notification-rule reminder">
                    <h6><i class="fas fa-bell"></i> Lembretes Vencendo</h6>
                    <ul>
                        <li><strong>Quando aparecem:</strong> Lembretes vencendo em at√© 7 dias</li>
                        <li><strong>Param quando:</strong> Marcados como conclu√≠dos OU passam de 7 dias do vencimento</li>
                        <li><strong>Frequ√™ncia:</strong> M√°ximo 1 notifica√ß√£o por 24 horas por lembrete</li>
                        <li><strong>Condi√ß√µes:</strong> Status = "ativo" e n√£o conclu√≠do</li>
                    </ul>
                </div>

                <div class="notification-rule chamado">
                    <h6><i class="fas fa-ticket-alt"></i> Chamados Atualizados</h6>
                    <ul>
                        <li><strong>Quando aparecem:</strong> Chamados atualizados nas √∫ltimas 24 horas</li>
                        <li><strong>Param quando:</strong> Status = "Fechado" OU sem atualiza√ß√µes por 24h</li>
                        <li><strong>Frequ√™ncia:</strong> M√°ximo 1 notifica√ß√£o por hora por chamado</li>
                        <li><strong>Conte√∫do:</strong> Mostra n√∫mero, t√≠tulo e status atual</li>
                    </ul>
                </div>

                <div class="notification-rule task">
                    <h6><i class="fas fa-tasks"></i> Tarefas Vencidas</h6>
                    <ul>
                        <li><strong>Quando aparecem:</strong> Tarefas com data anterior a hoje</li>
                        <li><strong>Param quando:</strong> Marcadas como conclu√≠das</li>
                        <li><strong>Frequ√™ncia:</strong> M√°ximo 1 notifica√ß√£o a cada 4 horas (agrupadas)</li>
                        <li><strong>Conte√∫do:</strong> Quantidade total de tarefas em atraso</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Lembretes -->
    <div class="row">
        <div class="col-12">
            <div class="help-section" id="reminders">
                <h3><i class="fas fa-calendar-alt"></i> Gest√£o de Lembretes</h3>
                
                <h5>Como Criar um Lembrete</h5>
                <ol>
                    <li>Acesse <strong>"Lembretes"</strong> no menu</li>
                    <li>Clique em <strong>"Novo Lembrete"</strong></li>
                    <li>Preencha os campos obrigat√≥rios:
                        <ul>
                            <li><strong>Nome:</strong> Descri√ß√£o clara do lembrete</li>
                            <li><strong>Tipo:</strong> Categoria para organiza√ß√£o</li>
                            <li><strong>Vencimento:</strong> Data limite</li>
                            <li><strong>Respons√°vel:</strong> Quem deve executar</li>
                            <li><strong>Frequ√™ncia:</strong> Di√°rio, quinzenal, mensal, anual</li>
                            <li><strong>Setor:</strong> Setor respons√°vel</li>
                        </ul>
                    </li>
                    <li>Configure op√ß√µes avan√ßadas (opcional):
                        <ul>
                            <li><strong>Pausar at√©:</strong> Data para pausa tempor√°ria</li>
                            <li><strong>Data de fim:</strong> T√©rmino da recorr√™ncia</li>
                        </ul>
                    </li>
                </ol>

                <h5>Status dos Lembretes</h5>
                <div class="mb-3">
                    <span class="status-badge active">Ativo</span> - Lembrete funcionando normalmente
                    <span class="status-badge paused">Pausado</span> - Temporariamente desativado
                    <span class="status-badge completed">Conclu√≠do</span> - Tarefa realizada
                    <span class="status-badge cancelled">Cancelado</span> - Lembrete cancelado permanentemente
                </div>

                <h5>Controles Dispon√≠veis</h5>
                <ul>
                    <li><strong>‚è∏Ô∏è Pausar:</strong> Pausa temporariamente o lembrete</li>
                    <li><strong>‚ñ∂Ô∏è Reativar:</strong> Reativa um lembrete pausado</li>
                    <li><strong>‚úÖ Concluir:</strong> Marca como realizado</li>
                    <li><strong>‚úèÔ∏è Editar:</strong> Modifica informa√ß√µes do lembrete</li>
                    <li><strong>üóëÔ∏è Excluir:</strong> Remove permanentemente (apenas admin)</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Chamados -->
    <div class="row">
        <div class="col-12">
            <div class="help-section" id="chamados">
                <h3><i class="fas fa-ticket-alt"></i> Sistema de Chamados</h3>
                
                <h5>Como Abrir um Chamado</h5>
                <ol>
                    <li>Acesse <strong>"Chamados"</strong> no menu</li>
                    <li>Clique em <strong>"Abrir Novo Chamado"</strong></li>
                    <li>Preencha o formul√°rio:
                        <ul>
                            <li><strong>T√≠tulo:</strong> Resumo claro do problema</li>
                            <li><strong>Descri√ß√£o:</strong> Detalhes completos do problema ou solicita√ß√£o</li>
                            <li><strong>Prioridade:</strong> Baixa, M√©dia, Alta, Cr√≠tica</li>
                        </ul>
                    </li>
                    <li>Clique em <strong>"Abrir Chamado"</strong></li>
                    <li>A TI ser√° notificada automaticamente por e-mail</li>
                </ol>

                <h5>Fluxo de Status</h5>
                <div class="alert alert-light">
                    <strong>Aberto</strong> ‚Üí <strong>Em Andamento</strong> ‚Üí <strong>Resolvido</strong> ‚Üí <strong>Fechado</strong>
                </div>

                <h5>Acompanhamento</h5>
                <ul>
                    <li><strong>Lista de Chamados:</strong> Veja todos os seus chamados</li>
                    <li><strong>Filtros:</strong> Por status, prioridade, data</li>
                    <li><strong>Detalhes:</strong> Clique no chamado para informa√ß√µes completas</li>
                    <li><strong>Coment√°rios:</strong> Adicione coment√°rios para acompanhamento</li>
                    <li><strong>Notifica√ß√µes:</strong> Receba alertas sobre atualiza√ß√µes</li>
                </ul>

                <h5>N√≠veis de Prioridade</h5>
                <ul>
                    <li><strong>Cr√≠tica:</strong> Sistema fora do ar, impacto total</li>
                    <li><strong>Alta:</strong> Funcionalidade importante afetada</li>
                    <li><strong>M√©dia:</strong> Problema que pode aguardar</li>
                    <li><strong>Baixa:</strong> Melhorias ou d√∫vidas</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Tarefas -->
    <div class="row">
        <div class="col-12">
            <div class="help-section" id="tasks">
                <h3><i class="fas fa-tasks"></i> Gest√£o de Tarefas</h3>
                
                <h5>Como Criar uma Tarefa</h5>
                <ol>
                    <li>Acesse <strong>"Tarefas"</strong> no menu</li>
                    <li>Preencha o formul√°rio:
                        <ul>
                            <li><strong>Descri√ß√£o:</strong> O que precisa ser feito</li>
                            <li><strong>Data:</strong> Prazo para conclus√£o</li>
                            <li><strong>Setor:</strong> Setor respons√°vel</li>
                        </ul>
                    </li>
                    <li>Clique em <strong>"Adicionar Tarefa"</strong></li>
                </ol>

                <h5>Controles de Tarefa</h5>
                <ul>
                    <li><strong>‚úÖ Concluir:</strong> Marca tarefa como finalizada</li>
                    <li><strong>‚úèÔ∏è Editar:</strong> Modifica descri√ß√£o ou data</li>
                    <li><strong>üóëÔ∏è Excluir:</strong> Remove a tarefa (apenas admin)</li>
                </ul>

                <h5>Filtros Dispon√≠veis</h5>
                <ul>
                    <li><strong>Status:</strong> Pendentes ou Conclu√≠das</li>
                    <li><strong>Data:</strong> Por per√≠odo espec√≠fico</li>
                    <li><strong>Busca:</strong> Por texto na descri√ß√£o</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Tutoriais -->
    <div class="row">
        <div class="col-12">
            <div class="help-section" id="tutorials">
                <h3><i class="fas fa-book"></i> Sistema de Tutoriais</h3>
                
                <h5>Como Usar os Tutoriais</h5>
                <ol>
                    <li>Acesse <strong>"Tutoriais"</strong> no menu</li>
                    <li>Use a busca para encontrar tutoriais espec√≠ficos</li>
                    <li>Clique em <strong>"Ver detalhes"</strong> para abrir o tutorial</li>
                    <li>Leia o conte√∫do e siga as instru√ß√µes</li>
                    <li>Deixe feedback se foi √∫til ou n√£o</li>
                    <li>Adicione coment√°rios com d√∫vidas ou sugest√µes</li>
                </ol>

                <h5>Recursos Dispon√≠veis</h5>
                <ul>
                    <li><strong>Busca:</strong> Encontre tutoriais por t√≠tulo ou categoria</li>
                    <li><strong>Categorias:</strong> Tutoriais organizados por assunto</li>
                    <li><strong>Feedback:</strong> Marque se o tutorial foi √∫til</li>
                    <li><strong>Coment√°rios:</strong> Tire d√∫vidas ou d√™ sugest√µes</li>
                    <li><strong>Exportar PDF:</strong> Baixe o tutorial para uso offline</li>
                </ul>

                <h5>Para Equipe de TI</h5>
                <p>Apenas membros da equipe de TI e administradores podem:</p>
                <ul>
                    <li>Criar novos tutoriais</li>
                    <li>Editar tutoriais existentes</li>
                    <li>Excluir tutoriais</li>
                    <li>Usar formata√ß√£o Markdown</li>
                    <li>Adicionar imagens</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Equipamentos -->
    <div class="row">
        <div class="col-12">
            <div class="help-section" id="equipment">
                <h3><i class="fas fa-laptop"></i> Gest√£o de Equipamentos</h3>
                
                <h5>Como Solicitar um Equipamento</h5>
                <ol>
                    <li>Acesse <strong>"Equipamentos"</strong> no menu</li>
                    <li>Clique em <strong>"Nova Solicita√ß√£o"</strong></li>
                    <li>Preencha o formul√°rio:
                        <ul>
                            <li><strong>Descri√ß√£o:</strong> Equipamento necess√°rio</li>
                            <li><strong>Tipo:</strong> Categoria do equipamento</li>
                            <li><strong>Motivo:</strong> Justificativa da solicita√ß√£o</li>
                            <li><strong>Setor de destino:</strong> Onde ser√° usado</li>
                            <li><strong>Data de entrega:</strong> Quando precisa</li>
                        </ul>
                    </li>
                    <li>Envie a solicita√ß√£o</li>
                </ol>

                <h5>Fluxo de Aprova√ß√£o</h5>
                <div class="alert alert-light">
                    <strong>Solicitado</strong> ‚Üí <strong>Aprovado</strong> ‚Üí <strong>Entregue</strong> ‚Üí <strong>Devolvido</strong>
                    <br><small class="text-muted">Ou pode ser <strong>Negado</strong> se n√£o aprovado</small>
                </div>

                <h5>Acompanhamento</h5>
                <ul>
                    <li><strong>Status:</strong> Veja o andamento da sua solicita√ß√£o</li>
                    <li><strong>Hist√≥rico:</strong> Acompanhe todas as movimenta√ß√µes</li>
                    <li><strong>Detalhes:</strong> Informa√ß√µes completas do equipamento</li>
                    <li><strong>Edi√ß√£o:</strong> Modifique solicita√ß√µes pendentes</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- Solu√ß√£o de Problemas -->
    <div class="row">
        <div class="col-12">
            <div class="help-section" id="troubleshooting">
                <h3><i class="fas fa-tools"></i> Solu√ß√£o de Problemas</h3>
                
                <h5>Problemas com Notifica√ß√µes</h5>
                <div class="alert alert-warning">
                    <strong>N√£o recebo notifica√ß√µes:</strong>
                    <ol>
                        <li>Verifique se est√£o habilitadas no navegador</li>
                        <li>Clique no √≠cone de cadeado na barra de endere√ßos</li>
                        <li>Selecione "Permitir" para notifica√ß√µes</li>
                        <li>Recarregue a p√°gina</li>
                    </ol>
                </div>

                <div class="alert alert-info">
                    <strong>Muitas notifica√ß√µes:</strong>
                    <p>O sistema j√° possui controles autom√°ticos para evitar spam. Cada tipo de notifica√ß√£o tem sua pr√≥pria frequ√™ncia controlada.</p>
                </div>

                <div class="alert alert-success">
                    <strong>Notifica√ß√µes param de aparecer:</strong>
                    <p>Isso √© normal! As notifica√ß√µes param automaticamente quando os itens s√£o resolvidos conforme as regras de neg√≥cio.</p>
                </div>

                <h5>Problemas de Login</h5>
                <ul>
                    <li><strong>Esqueci a senha:</strong> Entre em contato com o administrador</li>
                    <li><strong>Usu√°rio bloqueado:</strong> Solicite desbloqueio ao admin</li>
                    <li><strong>Erro de permiss√£o:</strong> Verifique se tem acesso √† funcionalidade</li>
                </ul>

                <h5>Problemas de Performance</h5>
                <ul>
                    <li><strong>P√°gina lenta:</strong> Limpe o cache do navegador</li>
                    <li><strong>Erro 500:</strong> Recarregue a p√°gina ou contate a TI</li>
                    <li><strong>Dados n√£o salvam:</strong> Verifique sua conex√£o com a internet</li>
                </ul>

                <h5>Contato para Suporte</h5>
                <div class="alert alert-primary">
                    <strong><i class="fas fa-headset"></i> Precisa de mais ajuda?</strong>
                    <p>Abra um chamado atrav√©s do sistema ou entre em contato com a equipe de TI.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Acesso R√°pido -->
    <div class="row">
        <div class="col-12">
            <h3><i class="fas fa-rocket"></i> Acesso R√°pido</h3>
            <div class="quick-access">
                <a href="{{ url_for('main.reminders') }}" class="quick-access-card">
                    <i class="fas fa-bell fa-2x mb-2"></i>
                    <h5>Lembretes</h5>
                    <p>Criar e gerenciar lembretes recorrentes</p>
                </a>
                
                <a href="{{ url_for('main.abrir_chamado') }}" class="quick-access-card">
                    <i class="fas fa-ticket-alt fa-2x mb-2"></i>
                    <h5>Abrir Chamado</h5>
                    <p>Solicitar suporte t√©cnico</p>
                </a>
                
                <a href="{{ url_for('main.tasks') }}" class="quick-access-card">
                    <i class="fas fa-tasks fa-2x mb-2"></i>
                    <h5>Tarefas</h5>
                    <p>Gerenciar suas tarefas</p>
                </a>
                
                <a href="{{ url_for('main.listar_tutoriais') }}" class="quick-access-card">
                    <i class="fas fa-book fa-2x mb-2"></i>
                    <h5>Tutoriais</h5>
                    <p>Consultar guias e manuais</p>
                </a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Smooth scrolling para links do √≠ndice
document.querySelectorAll('.toc a[href^="#"]').forEach(anchor => {
    anchor.addEventListener('click', function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute('href'));
        if (target) {
            target.scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }
    });
});

// Highlight da se√ß√£o atual no scroll
window.addEventListener('scroll', function() {
    const sections = document.querySelectorAll('.help-section');
    const tocLinks = document.querySelectorAll('.toc a');
    
    let current = '';
    sections.forEach(section => {
        const sectionTop = section.offsetTop;
        const sectionHeight = section.clientHeight;
        if (pageYOffset >= (sectionTop - 200)) {
            current = section.getAttribute('id');
        }
    });
    
    tocLinks.forEach(link => {
        link.classList.remove('fw-bold');
        if (link.getAttribute('href') === '#' + current) {
            link.classList.add('fw-bold');
        }
    });
});
</script>
{% endblock %}
