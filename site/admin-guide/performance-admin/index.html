<!DOCTYPE html>
<html class="writer-html5" lang="pt_BR" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Oézios Normando - Equipe TI OSN" /><link rel="canonical" href="http://192.168.1.86:5000/docs/admin-guide/performance-admin/" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>Performance - TI OSN System - Documentação Oficial</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" rel="stylesheet" />
        <link href="../../stylesheets/extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "Performance";
        var mkdocs_page_input_path = "admin-guide\\performance-admin.md";
        var mkdocs_page_url = "/docs/admin-guide/performance-admin/";
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> TI OSN System - Documentação Oficial
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Buscar documentos" aria-label="Buscar documentos" title="Digite o termo a ser buscado aqui" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Menu de navegação">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Início</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../apresentacao/">Apresentação do Sistema</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../RESUMO_EXECUTIVO/">Resumo Executivo</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Guia do Usuário</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/overview/">Visão Geral</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/security/">Segurança</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/tasks/">Atividades & Projetos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/reminders/">Notificações Programadas</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/chamados/">Tickets & Suporte</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/equipment/">Gestão de Ativos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/tutorials/">Base de Conhecimento</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/equipment/">Equipamentos</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/dashboard/">Dashboard</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/rfid/">Sistema RFID</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/satisfaction/">Avaliação de Satisfação</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/certifications/">Certificações</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../user-guide/performance/">Performance</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Guia do Administrador</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../security-admin/">Gerenciamento de Segurança</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../equipment-admin/">Equipamentos</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="./">Performance</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#visao-geral-do-sistema">Visão Geral do Sistema</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#componentes-monitorados">Componentes Monitorados</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#infraestrutura">Infraestrutura</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#metricas-principais">Métricas Principais</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#configuracao-do-monitoramento">Configuração do Monitoramento</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1-thresholds-de-alerta">1. Thresholds de Alerta</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#configuracoes-recomendadas">Configurações Recomendadas</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#personalizacao-por-ambiente">Personalização por Ambiente</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#2-canais-de-notificacao">2. Canais de Notificação</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#configuracao-de-alertas">Configuração de Alertas</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#dashboard-de-performance">Dashboard de Performance</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#metricas-em-tempo-real">Métricas em Tempo Real</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#visualizacoes-principais">Visualizações Principais</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#drill-down-analytics">Drill-Down Analytics</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#relatorios-automaticos">Relatórios Automáticos</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#relatorio-diario">Relatório Diário</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#relatorio-semanal">Relatório Semanal</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#otimizacoes-automaticas">Otimizações Automáticas</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1-otimizacao-de-banco-de-dados">1. Otimização de Banco de Dados</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#indices-automaticos">Índices Automáticos</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#configuracoes-dinamicas">Configurações Dinâmicas</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#2-otimizacao-de-aplicacao">2. Otimização de Aplicação</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#cache-inteligente">Cache Inteligente</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#connection-pooling">Connection Pooling</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#3-otimizacao-de-queries">3. Otimização de Queries</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#query-optimization">Query Optimization</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#troubleshooting-de-performance">Troubleshooting de Performance</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#problemas-comuns-e-solucoes">Problemas Comuns e Soluções</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#1-alto-uso-de-cpu">1. Alto Uso de CPU</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#2-alto-uso-de-memoria">2. Alto Uso de Memória</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#3-queries-lentas">3. Queries Lentas</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#4-conexoes-de-banco-excedidas">4. Conexões de Banco Excedidas</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#estrategias-de-escalabilidade">Estratégias de Escalabilidade</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1-horizontal-scaling">1. Horizontal Scaling</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#load-balancing">Load Balancing</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#database-replication">Database Replication</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#2-vertical-scaling">2. Vertical Scaling</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#otimizacao-de-recursos">Otimização de Recursos</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#3-cache-strategies">3. Cache Strategies</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#redis-implementation">Redis Implementation</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#monitoramento-avancado">Monitoramento Avançado</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#apm-application-performance-monitoring">APM (Application Performance Monitoring)</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#ferramentas-recomendadas">Ferramentas Recomendadas</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#metricas-customizadas">Métricas Customizadas</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#log-analysis">Log Analysis</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#estrutura-de-logs">Estrutura de Logs</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#analise-com-elk-stack">Análise com ELK Stack</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#plano-de-contingencia">Plano de Contingência</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#cenarios-de-falha">Cenários de Falha</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#1-falha-de-banco-de-dados">1. Falha de Banco de Dados</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#2-sobrecarga-de-cpumemoria">2. Sobrecarga de CPU/Memória</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#3-ataque-ddos">3. Ataque DDoS</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#testes-de-stress">Testes de Stress</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#ferramentas-recomendadas_1">Ferramentas Recomendadas</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#manutencao-preventiva">Manutenção Preventiva</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#tarefas-regulares">Tarefas Regulares</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#diaria">Diária</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#semanal">Semanal</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#mensal">Mensal</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#automacao-de-manutencao">Automação de Manutenção</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#scripts-de-manutencao">Scripts de Manutenção</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#suporte-e-documentacao">Suporte e Documentação</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#recursos-de-suporte">Recursos de Suporte</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#metricas-de-sla">Métricas de SLA</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../rfid-admin/">RFID</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../satisfaction-admin/">Satisfação</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../certifications-admin/">Certificações</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Guia do Desenvolvedor</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../dev-guide/security-implementation/">Implementação de Segurança</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Menu de navegação em dispositivo móvel">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">TI OSN System - Documentação Oficial</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Documentos"></a></li>
          <li class="breadcrumb-item">Guia do Administrador</li>
      <li class="breadcrumb-item active">Performance</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="administracao-do-sistema-de-performance">Administração do Sistema de Performance<a class="headerlink" href="#administracao-do-sistema-de-performance" title="Permanent link">&para;</a></h1>
<p>Guia completo para administradores monitorarem e otimizarem a performance do sistema TI OSN, garantindo alta disponibilidade e eficiência operacional.</p>
<h2 id="visao-geral-do-sistema">Visão Geral do Sistema<a class="headerlink" href="#visao-geral-do-sistema" title="Permanent link">&para;</a></h2>
<h3 id="componentes-monitorados">Componentes Monitorados<a class="headerlink" href="#componentes-monitorados" title="Permanent link">&para;</a></h3>
<h4 id="infraestrutura">Infraestrutura<a class="headerlink" href="#infraestrutura" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Servidor</strong>: CPU, memória, disco, rede</li>
<li><strong>Banco de Dados</strong>: PostgreSQL com métricas específicas</li>
<li><strong>Aplicação</strong>: Flask com métricas de performance</li>
<li><strong>Cache</strong>: Redis (se implementado)</li>
</ul>
<h4 id="metricas-principais">Métricas Principais<a class="headerlink" href="#metricas-principais" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Latência</strong>: Tempo de resposta das APIs</li>
<li><strong>Throughput</strong>: Requisições por segundo</li>
<li><strong>Disponibilidade</strong>: Uptime do sistema</li>
<li><strong>Erros</strong>: Taxa de falhas por endpoint</li>
</ul>
<h2 id="configuracao-do-monitoramento">Configuração do Monitoramento<a class="headerlink" href="#configuracao-do-monitoramento" title="Permanent link">&para;</a></h2>
<h3 id="1-thresholds-de-alerta">1. Thresholds de Alerta<a class="headerlink" href="#1-thresholds-de-alerta" title="Permanent link">&para;</a></h3>
<h4 id="configuracoes-recomendadas">Configurações Recomendadas<a class="headerlink" href="#configuracoes-recomendadas" title="Permanent link">&para;</a></h4>
<pre><code class="language-python">PERFORMANCE_THRESHOLDS = {
    'cpu_warning': 70,      # % CPU para aviso
    'cpu_critical': 85,     # % CPU crítico
    'memory_warning': 80,   # % Memória para aviso
    'memory_critical': 90,  # % Memória crítico
    'disk_warning': 85,     # % Disco para aviso
    'disk_critical': 95,    # % Disco crítico
    'response_time_warning': 2.0,  # Segundos
    'response_time_critical': 5.0, # Segundos
    'error_rate_warning': 5,       # % erros
    'error_rate_critical': 10,     # % erros
}
</code></pre>
<h4 id="personalizacao-por-ambiente">Personalização por Ambiente<a class="headerlink" href="#personalizacao-por-ambiente" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Desenvolvimento</strong>: Thresholds mais permissivos</li>
<li><strong>Homologação</strong>: Valores intermediários</li>
<li><strong>Produção</strong>: Thresholds rigorosos</li>
</ul>
<h3 id="2-canais-de-notificacao">2. Canais de Notificação<a class="headerlink" href="#2-canais-de-notificacao" title="Permanent link">&para;</a></h3>
<h4 id="configuracao-de-alertas">Configuração de Alertas<a class="headerlink" href="#configuracao-de-alertas" title="Permanent link">&para;</a></h4>
<pre><code class="language-python">ALERT_CHANNELS = {
    'email': {
        'enabled': True,
        'recipients': ['admin@empresa.com', 'ti@empresa.com'],
        'severity_levels': ['warning', 'critical']
    },
    'slack': {
        'enabled': True,
        'webhook_url': 'https://hooks.slack.com/...',
        'channel': '#alerts-performance'
    },
    'sms': {
        'enabled': False,
        'provider': 'twilio',
        'numbers': ['+5511999999999']
    }
}
</code></pre>
<h2 id="dashboard-de-performance">Dashboard de Performance<a class="headerlink" href="#dashboard-de-performance" title="Permanent link">&para;</a></h2>
<h3 id="metricas-em-tempo-real">Métricas em Tempo Real<a class="headerlink" href="#metricas-em-tempo-real" title="Permanent link">&para;</a></h3>
<h4 id="visualizacoes-principais">Visualizações Principais<a class="headerlink" href="#visualizacoes-principais" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>CPU/Memória/Disco</strong>: Gráficos de linha em tempo real</li>
<li><strong>Conexões DB</strong>: Número de conexões ativas</li>
<li><strong>Cache Hit Ratio</strong>: Eficiência do cache PostgreSQL</li>
<li><strong>Latência de Queries</strong>: Tempo médio de resposta</li>
</ul>
<h4 id="drill-down-analytics">Drill-Down Analytics<a class="headerlink" href="#drill-down-analytics" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Por Endpoint</strong>: Performance por rota da API</li>
<li><strong>Por Usuário</strong>: Impacto de usuários específicos</li>
<li><strong>Por Período</strong>: Tendências horárias/diárias</li>
<li><strong>Por Tipo de Query</strong>: SELECT vs INSERT vs UPDATE</li>
</ul>
<h3 id="relatorios-automaticos">Relatórios Automáticos<a class="headerlink" href="#relatorios-automaticos" title="Permanent link">&para;</a></h3>
<h4 id="relatorio-diario">Relatório Diário<a class="headerlink" href="#relatorio-diario" title="Permanent link">&para;</a></h4>
<pre><code class="language-python">DAILY_REPORT_CONFIG = {
    'metrics': [
        'avg_response_time',
        'total_requests',
        'error_rate',
        'db_connections_peak',
        'cache_hit_ratio'
    ],
    'format': 'html',  # html, pdf, json
    'recipients': ['management@empresa.com'],
    'schedule': '08:00'  # Horário de envio
}
</code></pre>
<h4 id="relatorio-semanal">Relatório Semanal<a class="headerlink" href="#relatorio-semanal" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Tendências</strong>: Comparativo com semana anterior</li>
<li><strong>Picos de Uso</strong>: Identificação de bottlenecks</li>
<li><strong>Recomendações</strong>: Ações de otimização</li>
</ul>
<h2 id="otimizacoes-automaticas">Otimizações Automáticas<a class="headerlink" href="#otimizacoes-automaticas" title="Permanent link">&para;</a></h2>
<h3 id="1-otimizacao-de-banco-de-dados">1. Otimização de Banco de Dados<a class="headerlink" href="#1-otimizacao-de-banco-de-dados" title="Permanent link">&para;</a></h3>
<h4 id="indices-automaticos">Índices Automáticos<a class="headerlink" href="#indices-automaticos" title="Permanent link">&para;</a></h4>
<pre><code class="language-sql">-- Criação automática de índices
CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_performance_logs_timestamp
ON performance_logs (timestamp DESC);

CREATE INDEX CONCURRENTLY IF NOT EXISTS idx_chamado_status_performance
ON chamado (status, data_abertura)
WHERE status IN ('Aberto', 'Em Andamento');
</code></pre>
<h4 id="configuracoes-dinamicas">Configurações Dinâmicas<a class="headerlink" href="#configuracoes-dinamicas" title="Permanent link">&para;</a></h4>
<pre><code class="language-sql">-- Ajuste automático de parâmetros PostgreSQL
ALTER SYSTEM SET work_mem = '128MB';
ALTER SYSTEM SET maintenance_work_mem = '256MB';
ALTER SYSTEM SET effective_cache_size = '2GB';
</code></pre>
<h3 id="2-otimizacao-de-aplicacao">2. Otimização de Aplicação<a class="headerlink" href="#2-otimizacao-de-aplicacao" title="Permanent link">&para;</a></h3>
<h4 id="cache-inteligente">Cache Inteligente<a class="headerlink" href="#cache-inteligente" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Query Result Cache</strong>: Cache de resultados frequentes</li>
<li><strong>Template Cache</strong>: Cache de templates Jinja2</li>
<li><strong>Static Files</strong>: Cache de assets estáticos</li>
</ul>
<h4 id="connection-pooling">Connection Pooling<a class="headerlink" href="#connection-pooling" title="Permanent link">&para;</a></h4>
<pre><code class="language-python"># Configuração do pool de conexões
SQLALCHEMY_POOL_SIZE = 20
SQLALCHEMY_MAX_OVERFLOW = 30
SQLALCHEMY_POOL_TIMEOUT = 30
SQLALCHEMY_POOL_RECYCLE = 3600
</code></pre>
<h3 id="3-otimizacao-de-queries">3. Otimização de Queries<a class="headerlink" href="#3-otimizacao-de-queries" title="Permanent link">&para;</a></h3>
<h4 id="query-optimization">Query Optimization<a class="headerlink" href="#query-optimization" title="Permanent link">&para;</a></h4>
<pre><code class="language-python"># Exemplo de query otimizada
def get_chamados_optimized(user_id, status=None, limit=50):
    query = db.session.query(Chamado).options(
        # Carregamento eager de relacionamentos
        joinedload(Chamado.solicitante),
        joinedload(Chamado.responsavel_ti),
        joinedload(Chamado.setor)
    ).filter(Chamado.solicitante_id == user_id)

    if status:
        query = query.filter(Chamado.status == status)

    return query.order_by(Chamado.data_abertura.desc()).limit(limit).all()
</code></pre>
<h2 id="troubleshooting-de-performance">Troubleshooting de Performance<a class="headerlink" href="#troubleshooting-de-performance" title="Permanent link">&para;</a></h2>
<h3 id="problemas-comuns-e-solucoes">Problemas Comuns e Soluções<a class="headerlink" href="#problemas-comuns-e-solucoes" title="Permanent link">&para;</a></h3>
<h4 id="1-alto-uso-de-cpu">1. Alto Uso de CPU<a class="headerlink" href="#1-alto-uso-de-cpu" title="Permanent link">&para;</a></h4>
<p><strong>Sintomas</strong>: Sistema lento, timeouts
<strong>Causas Possíveis</strong>:
- Queries não otimizadas
- Loops infinitos
- Processamento excessivo</p>
<p><strong>Soluções</strong>:</p>
<pre><code class="language-bash"># Identificar processos com alto CPU
ps aux --sort=-%cpu | head -10

# Analisar queries lentas
EXPLAIN ANALYZE SELECT * FROM tabela WHERE condicao;
</code></pre>
<h4 id="2-alto-uso-de-memoria">2. Alto Uso de Memória<a class="headerlink" href="#2-alto-uso-de-memoria" title="Permanent link">&para;</a></h4>
<p><strong>Sintomas</strong>: Out of memory, swapping
<strong>Causas Possíveis</strong>:
- Memory leaks
- Datasets grandes em memória
- Configuração inadequada</p>
<p><strong>Soluções</strong>:</p>
<pre><code class="language-python"># Monitorar uso de memória
import tracemalloc
tracemalloc.start()
# ... código ...
current, peak = tracemalloc.get_traced_memory()
print(f&quot;Current memory usage: {current / 1024 / 1024:.1f} MB&quot;)
print(f&quot;Peak memory usage: {peak / 1024 / 1024:.1f} MB&quot;)
</code></pre>
<h4 id="3-queries-lentas">3. Queries Lentas<a class="headerlink" href="#3-queries-lentas" title="Permanent link">&para;</a></h4>
<p><strong>Sintomas</strong>: Timeouts, lentidão geral
<strong>Causas Possíveis</strong>:
- Falta de índices
- Queries complexas
- Lock de tabelas</p>
<p><strong>Soluções</strong>:</p>
<pre><code class="language-sql">-- Analisar query lenta
EXPLAIN (ANALYZE, BUFFERS) SELECT * FROM tabela WHERE condicao;

-- Verificar locks
SELECT * FROM pg_locks WHERE NOT granted;
</code></pre>
<h4 id="4-conexoes-de-banco-excedidas">4. Conexões de Banco Excedidas<a class="headerlink" href="#4-conexoes-de-banco-excedidas" title="Permanent link">&para;</a></h4>
<p><strong>Sintomas</strong>: Erro "too many connections"
<strong>Causas Possíveis</strong>:
- Connection leaks
- Pool inadequado
- Queries long-running</p>
<p><strong>Soluções</strong>:</p>
<pre><code class="language-sql">-- Verificar conexões ativas
SELECT count(*) as active_connections FROM pg_stat_activity;

-- Configurar pool
ALTER SYSTEM SET max_connections = 200;
</code></pre>
<h2 id="estrategias-de-escalabilidade">Estratégias de Escalabilidade<a class="headerlink" href="#estrategias-de-escalabilidade" title="Permanent link">&para;</a></h2>
<h3 id="1-horizontal-scaling">1. Horizontal Scaling<a class="headerlink" href="#1-horizontal-scaling" title="Permanent link">&para;</a></h3>
<h4 id="load-balancing">Load Balancing<a class="headerlink" href="#load-balancing" title="Permanent link">&para;</a></h4>
<pre><code class="language-nginx">upstream ti_osn_app {
    server app1:5000;
    server app2:5000;
    server app3:5000;
}

server {
    listen 80;
    location / {
        proxy_pass http://ti_osn_app;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }
}
</code></pre>
<h4 id="database-replication">Database Replication<a class="headerlink" href="#database-replication" title="Permanent link">&para;</a></h4>
<pre><code class="language-sql">-- Configuração de réplica
ALTER SYSTEM SET wal_level = replica;
ALTER SYSTEM SET max_wal_senders = 3;
ALTER SYSTEM SET hot_standby = on;
</code></pre>
<h3 id="2-vertical-scaling">2. Vertical Scaling<a class="headerlink" href="#2-vertical-scaling" title="Permanent link">&para;</a></h3>
<h4 id="otimizacao-de-recursos">Otimização de Recursos<a class="headerlink" href="#otimizacao-de-recursos" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>CPU</strong>: Upgrade para processadores mais rápidos</li>
<li><strong>Memória</strong>: Aumento de RAM</li>
<li><strong>Disco</strong>: SSDs de alta performance</li>
<li><strong>Rede</strong>: Conexões de alta velocidade</li>
</ul>
<h3 id="3-cache-strategies">3. Cache Strategies<a class="headerlink" href="#3-cache-strategies" title="Permanent link">&para;</a></h3>
<h4 id="redis-implementation">Redis Implementation<a class="headerlink" href="#redis-implementation" title="Permanent link">&para;</a></h4>
<pre><code class="language-python">from flask_caching import Cache

cache = Cache(config={
    'CACHE_TYPE': 'redis',
    'CACHE_REDIS_HOST': 'localhost',
    'CACHE_REDIS_PORT': 6379,
    'CACHE_REDIS_DB': 0
})

@cache.memoize(timeout=300)  # Cache por 5 minutos
def get_dashboard_data(user_id):
    # Dados do dashboard
    return expensive_query(user_id)
</code></pre>
<h2 id="monitoramento-avancado">Monitoramento Avançado<a class="headerlink" href="#monitoramento-avancado" title="Permanent link">&para;</a></h2>
<h3 id="apm-application-performance-monitoring">APM (Application Performance Monitoring)<a class="headerlink" href="#apm-application-performance-monitoring" title="Permanent link">&para;</a></h3>
<h4 id="ferramentas-recomendadas">Ferramentas Recomendadas<a class="headerlink" href="#ferramentas-recomendadas" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>New Relic</strong>: Monitoramento completo</li>
<li><strong>Datadog</strong>: Métricas e alertas</li>
<li><strong>Prometheus + Grafana</strong>: Stack open source</li>
<li><strong>Application Insights</strong>: Para Azure</li>
</ul>
<h4 id="metricas-customizadas">Métricas Customizadas<a class="headerlink" href="#metricas-customizadas" title="Permanent link">&para;</a></h4>
<pre><code class="language-python">from flask import g
import time

@app.before_request
def start_timer():
    g.start = time.time()

@app.after_request
def log_request(response):
    if hasattr(g, 'start'):
        duration = time.time() - g.start
        # Log para sistema de monitoramento
        log_performance_metric('request_duration', duration, {
            'endpoint': request.endpoint,
            'method': request.method,
            'status_code': response.status_code
        })
    return response
</code></pre>
<h3 id="log-analysis">Log Analysis<a class="headerlink" href="#log-analysis" title="Permanent link">&para;</a></h3>
<h4 id="estrutura-de-logs">Estrutura de Logs<a class="headerlink" href="#estrutura-de-logs" title="Permanent link">&para;</a></h4>
<pre><code class="language-json">{
    &quot;timestamp&quot;: &quot;2024-01-15T10:30:00Z&quot;,
    &quot;level&quot;: &quot;INFO&quot;,
    &quot;service&quot;: &quot;ti-osn&quot;,
    &quot;endpoint&quot;: &quot;/api/chamados&quot;,
    &quot;user_id&quot;: 123,
    &quot;response_time&quot;: 0.234,
    &quot;status_code&quot;: 200,
    &quot;user_agent&quot;: &quot;Mozilla/5.0...&quot;,
    &quot;ip_address&quot;: &quot;192.168.1.100&quot;
}
</code></pre>
<h4 id="analise-com-elk-stack">Análise com ELK Stack<a class="headerlink" href="#analise-com-elk-stack" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Elasticsearch</strong>: Indexação de logs</li>
<li><strong>Logstash</strong>: Processamento e transformação</li>
<li><strong>Kibana</strong>: Visualização e dashboards</li>
</ul>
<h2 id="plano-de-contingencia">Plano de Contingência<a class="headerlink" href="#plano-de-contingencia" title="Permanent link">&para;</a></h2>
<h3 id="cenarios-de-falha">Cenários de Falha<a class="headerlink" href="#cenarios-de-falha" title="Permanent link">&para;</a></h3>
<h4 id="1-falha-de-banco-de-dados">1. Falha de Banco de Dados<a class="headerlink" href="#1-falha-de-banco-de-dados" title="Permanent link">&para;</a></h4>
<p><strong>Plano</strong>:
- Failover automático para réplica
- Notificação imediata para equipe
- Roteamento de leitura para réplicas</p>
<h4 id="2-sobrecarga-de-cpumemoria">2. Sobrecarga de CPU/Memória<a class="headerlink" href="#2-sobrecarga-de-cpumemoria" title="Permanent link">&para;</a></h4>
<p><strong>Plano</strong>:
- Auto-scaling horizontal
- Throttling de requests
- Queue de requests não críticos</p>
<h4 id="3-ataque-ddos">3. Ataque DDoS<a class="headerlink" href="#3-ataque-ddos" title="Permanent link">&para;</a></h4>
<p><strong>Plano</strong>:
- WAF (Web Application Firewall)
- Rate limiting
- CDN para absorver tráfego</p>
<h3 id="testes-de-stress">Testes de Stress<a class="headerlink" href="#testes-de-stress" title="Permanent link">&para;</a></h3>
<h4 id="ferramentas-recomendadas_1">Ferramentas Recomendadas<a class="headerlink" href="#ferramentas-recomendadas_1" title="Permanent link">&para;</a></h4>
<pre><code class="language-bash"># Apache Bench
ab -n 1000 -c 10 http://localhost:5000/

# Locust (Python)
from locust import HttpUser, task

class WebsiteUser(HttpUser):
    @task
    def index(self):
        self.client.get(&quot;/&quot;)
</code></pre>
<h2 id="manutencao-preventiva">Manutenção Preventiva<a class="headerlink" href="#manutencao-preventiva" title="Permanent link">&para;</a></h2>
<h3 id="tarefas-regulares">Tarefas Regulares<a class="headerlink" href="#tarefas-regulares" title="Permanent link">&para;</a></h3>
<h4 id="diaria">Diária<a class="headerlink" href="#diaria" title="Permanent link">&para;</a></h4>
<ul>
<li>Verificação de logs de erro</li>
<li>Monitoramento de espaço em disco</li>
<li>Backup de banco de dados</li>
</ul>
<h4 id="semanal">Semanal<a class="headerlink" href="#semanal" title="Permanent link">&para;</a></h4>
<ul>
<li>Análise de performance trends</li>
<li>Otimização de queries lentas</li>
<li>Atualização de dependências</li>
</ul>
<h4 id="mensal">Mensal<a class="headerlink" href="#mensal" title="Permanent link">&para;</a></h4>
<ul>
<li>Revisão de configurações</li>
<li>Testes de carga</li>
<li>Relatórios de capacity planning</li>
</ul>
<h3 id="automacao-de-manutencao">Automação de Manutenção<a class="headerlink" href="#automacao-de-manutencao" title="Permanent link">&para;</a></h3>
<h4 id="scripts-de-manutencao">Scripts de Manutenção<a class="headerlink" href="#scripts-de-manutencao" title="Permanent link">&para;</a></h4>
<pre><code class="language-bash">#!/bin/bash
# maintenance.sh

# Backup do banco
pg_dump ti_reminder_db &gt; backup_$(date +%Y%m%d).sql

# Limpeza de logs antigos
find /var/log/ti-osn -name &quot;*.log&quot; -mtime +30 -delete

# Otimização de tabelas
psql -d ti_reminder_db -c &quot;VACUUM ANALYZE;&quot;

# Reinício controlado
systemctl restart ti-osn-app
</code></pre>
<h2 id="suporte-e-documentacao">Suporte e Documentação<a class="headerlink" href="#suporte-e-documentacao" title="Permanent link">&para;</a></h2>
<h3 id="recursos-de-suporte">Recursos de Suporte<a class="headerlink" href="#recursos-de-suporte" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Documentação Técnica</strong>: docs/dev-guide/</li>
<li><strong>Runbooks</strong>: Procedimentos de resolução</li>
<li><strong>Equipe de Plantão</strong>: Contatos 24/7</li>
<li><strong>Ferramentas de Debug</strong>: Scripts de diagnóstico</li>
</ul>
<h3 id="metricas-de-sla">Métricas de SLA<a class="headerlink" href="#metricas-de-sla" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Disponibilidade</strong>: 99.9% (8.76h downtime/mês)</li>
<li><strong>Tempo de Resposta</strong>: &lt; 2s para 95% das requests</li>
<li><strong>Taxa de Erro</strong>: &lt; 1% de erro</li>
<li><strong>RPO/RTO</strong>: 1h / 4h (objetivos de recuperação)</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Navegação no rodapé">
        <a href="../equipment-admin/" class="btn btn-neutral float-left" title="Equipamentos"><span class="icon icon-circle-arrow-left"></span> Anterior</a>
        <a href="../rfid-admin/" class="btn btn-neutral float-right" title="RFID">Seguinte <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Construído com <a href="https://www.mkdocs.org/">MkDocs</a> usando <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provido por <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versões">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../equipment-admin/" style="color: #fcfcfc">&laquo; Anterior</a></span>
    
    
      <span><a href="../rfid-admin/" style="color: #fcfcfc">Seguinte &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../javascripts/extra.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
